{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://jettison.com/schemas/osd_config.json",
  "title": "OSD Configuration Schema",
  "description": "JSON Schema for Jettison OSD configuration (Draft-07). Note: Some runtime values like crosshair offset (offset_x/offset_y) come from protobuf state, not this config - see rec_osd.day_crosshair_offset_* and heat_crosshair_offset_* fields.",
  "type": "object",
  "required": ["crosshair", "timestamp", "speed_indicators", "variant_info", "navball", "celestial_indicators", "sharpness_heatmap", "detections"],
  "properties": {
    "crosshair": {
      "type": "object",
      "title": "Crosshair",
      "x-ui-level": "top",
      "x-ui-order": 10,
      "x-ui-collapsed": false,
      "required": ["enabled", "center_dot", "cross", "circle"],
      "properties": {
        "enabled": { "type": "boolean", "title": "Enabled" },
        "orientation": {
          "type": "string",
          "title": "Orientation",
          "enum": ["vertical", "diagonal"],
          "default": "vertical"
        },
        "center_dot": {
          "type": "object",
          "title": "Center Dot",
          "x-ui-level": "accordion",
          "x-ui-order": 10,
          "required": ["enabled", "radius", "color", "thickness"],
          "properties": {
            "enabled": { "type": "boolean", "title": "Enabled" },
            "radius": { "type": "number", "title": "Radius", "minimum": 0, "maximum": 50 },
            "color": { "$ref": "#/definitions/argb_color", "title": "Color" },
            "thickness": { "type": "number", "title": "Thickness", "minimum": 0.5, "maximum": 10 }
          }
        },
        "cross": {
          "type": "object",
          "title": "Cross Arms",
          "x-ui-level": "accordion",
          "x-ui-order": 20,
          "required": ["enabled", "length", "gap", "thickness", "color"],
          "properties": {
            "enabled": { "type": "boolean", "title": "Enabled" },
            "length": { "type": "number", "title": "Length", "minimum": 0, "maximum": 500 },
            "gap": { "type": "number", "title": "Gap", "minimum": 0, "maximum": 100 },
            "thickness": { "type": "number", "title": "Thickness", "minimum": 0.5, "maximum": 20 },
            "color": { "$ref": "#/definitions/argb_color", "title": "Color" }
          }
        },
        "circle": {
          "type": "object",
          "title": "Reference Circle",
          "x-ui-level": "accordion",
          "x-ui-order": 30,
          "required": ["enabled", "radius", "thickness", "color"],
          "properties": {
            "enabled": { "type": "boolean", "title": "Enabled" },
            "radius": { "type": "number", "title": "Radius", "minimum": 0, "maximum": 200 },
            "thickness": { "type": "number", "title": "Thickness", "minimum": 0.5, "maximum": 10 },
            "color": { "$ref": "#/definitions/argb_color", "title": "Color" }
          }
        }
      }
    },
    "timestamp": {
      "type": "object",
      "title": "Timestamp",
      "x-ui-level": "top",
      "x-ui-order": 30,
      "x-ui-collapsed": true,
      "required": ["enabled", "position_x", "position_y", "color", "font_size", "font"],
      "properties": {
        "enabled": { "type": "boolean", "title": "Enabled" },
        "position_x": { "type": "integer", "title": "Position X", "minimum": 0, "maximum": 3840 },
        "position_y": { "type": "integer", "title": "Position Y", "minimum": 0, "maximum": 2160 },
        "color": { "$ref": "#/definitions/argb_color", "title": "Color" },
        "font_size": { "type": "integer", "title": "Font Size", "minimum": 8, "maximum": 128 },
        "font": {
          "type": "string",
          "title": "Font",
          "enum": ["liberation_sans_bold", "b612_mono_bold", "share_tech_mono", "orbitron_bold"],
          "default": "liberation_sans_bold"
        }
      }
    },
    "speed_indicators": {
      "type": "object",
      "title": "Speed Indicators",
      "x-ui-level": "top",
      "x-ui-order": 40,
      "x-ui-collapsed": true,
      "required": ["enabled", "color", "font_size", "max_speed_azimuth", "max_speed_elevation", "font"],
      "properties": {
        "enabled": { "type": "boolean", "title": "Enabled" },
        "color": { "$ref": "#/definitions/argb_color", "title": "Color" },
        "font_size": { "type": "integer", "title": "Font Size", "minimum": 8, "maximum": 128 },
        "threshold": {
          "type": "number",
          "title": "Display Threshold",
          "minimum": 0.0,
          "maximum": 1.0,
          "default": 0.05,
          "description": "Minimum normalized speed (0.0-1.0) to show indicator"
        },
        "max_speed_azimuth": {
          "type": "number",
          "title": "Max Speed Azimuth",
          "minimum": 0.1,
          "maximum": 360.0,
          "default": 35.0,
          "description": "Maximum azimuth speed in degrees/second for normalization"
        },
        "max_speed_elevation": {
          "type": "number",
          "title": "Max Speed Elevation",
          "minimum": 0.1,
          "maximum": 360.0,
          "default": 35.0,
          "description": "Maximum elevation speed in degrees/second for normalization"
        },
        "font": {
          "type": "string",
          "title": "Font",
          "enum": ["liberation_sans_bold", "b612_mono_bold", "share_tech_mono", "orbitron_bold"],
          "default": "liberation_sans_bold"
        }
      }
    },
    "variant_info": {
      "type": "object",
      "title": "Debug Overlay",
      "x-ui-level": "top",
      "x-ui-order": 60,
      "x-ui-collapsed": true,
      "required": ["enabled", "position_x", "position_y", "color", "font_size", "font"],
      "properties": {
        "enabled": { "type": "boolean", "title": "Enabled" },
        "position_x": { "type": "integer", "title": "Position X", "minimum": 0, "maximum": 3840 },
        "position_y": { "type": "integer", "title": "Position Y", "minimum": 0, "maximum": 2160 },
        "color": { "$ref": "#/definitions/argb_color", "title": "Color" },
        "font_size": { "type": "integer", "title": "Font Size", "minimum": 8, "maximum": 128 },
        "font": {
          "type": "string",
          "title": "Font",
          "enum": ["liberation_sans_bold", "b612_mono_bold", "share_tech_mono", "orbitron_bold"],
          "default": "liberation_sans_bold"
        }
      }
    },
    "navball": {
      "type": "object",
      "title": "Navigation Ball",
      "x-ui-level": "top",
      "x-ui-order": 20,
      "x-ui-collapsed": false,
      "required": ["enabled", "position_x", "position_y", "size", "skin", "show_level_marker", "center_indicator"],
      "properties": {
        "enabled": { "type": "boolean", "title": "Enabled" },
        "position_x": { "type": "integer", "title": "Position X", "minimum": -500, "maximum": 3840 },
        "position_y": { "type": "integer", "title": "Position Y", "minimum": -500, "maximum": 2160 },
        "size": { "type": "integer", "title": "Size", "minimum": 50, "maximum": 1000 },
        "skin": {
          "type": "string",
          "title": "Skin",
          "enum": [
            "stock",
            "stock_iva",
            "5thHorseman_v2",
            "5thHorseman_black",
            "5thHorseman_brown",
            "jafo",
            "kbob_v2",
            "ordinary_kerman",
            "trekky",
            "apollo",
            "white_owl",
            "zasnold",
            "falconb"
          ]
        },
        "show_level_marker": { "type": "boolean", "title": "Show Level Marker" },
        "center_indicator": {
          "type": "object",
          "title": "Center Indicator",
          "x-ui-level": "accordion",
          "required": ["enabled", "indicator", "scale"],
          "properties": {
            "enabled": { "type": "boolean", "title": "Enabled" },
            "indicator": {
              "type": "string",
              "title": "Indicator",
              "enum": ["circle", "rectangle", "crosshair"]
            },
            "scale": { "type": "number", "title": "Scale", "minimum": 0.05, "maximum": 2.0 }
          }
        }
      }
    },
    "celestial_indicators": {
      "type": "object",
      "title": "Sun & Moon",
      "x-ui-level": "top",
      "x-ui-order": 50,
      "x-ui-collapsed": true,
      "required": ["enabled", "show_sun", "show_moon", "scale", "visibility_threshold", "sun_front_svg", "sun_back_svg", "moon_front_svg", "moon_back_svg"],
      "properties": {
        "enabled": { "type": "boolean", "title": "Enabled" },
        "show_sun": { "type": "boolean", "title": "Show Sun" },
        "show_moon": { "type": "boolean", "title": "Show Moon" },
        "scale": {
          "type": "number",
          "title": "Scale",
          "minimum": 0.1,
          "maximum": 5.0,
          "description": "Scale factor for celestial indicator size"
        },
        "visibility_threshold": {
          "type": "number",
          "title": "Visibility Threshold",
          "minimum": -90.0,
          "maximum": 90.0,
          "description": "Altitude threshold in degrees for showing celestial bodies"
        },
        "sun_front_svg": {
          "type": "string",
          "title": "Sun Front SVG",
          "description": "Path to sun front hemisphere SVG",
          "x-ui-hidden": true
        },
        "sun_back_svg": {
          "type": "string",
          "title": "Sun Back SVG",
          "description": "Path to sun back hemisphere SVG",
          "x-ui-hidden": true
        },
        "moon_front_svg": {
          "type": "string",
          "title": "Moon Front SVG",
          "description": "Path to moon front hemisphere SVG",
          "x-ui-hidden": true
        },
        "moon_back_svg": {
          "type": "string",
          "title": "Moon Back SVG",
          "description": "Path to moon back hemisphere SVG",
          "x-ui-hidden": true
        }
      }
    },
    "sharpness_heatmap": {
      "type": "object",
      "title": "Sharpness Heatmap",
      "x-ui-level": "top",
      "x-ui-order": 70,
      "x-ui-collapsed": true,
      "required": ["enabled", "position_x", "position_y", "cell_size", "show_label", "label_font_size"],
      "properties": {
        "enabled": { "type": "boolean", "title": "Enabled" },
        "position_x": { "type": "integer", "title": "Position X", "minimum": 0, "maximum": 3840 },
        "position_y": { "type": "integer", "title": "Position Y", "minimum": 0, "maximum": 2160 },
        "cell_size": {
          "type": "integer",
          "title": "Cell Size",
          "minimum": 4,
          "maximum": 32,
          "description": "Pixels per grid cell (8x8 grid)"
        },
        "show_label": { "type": "boolean", "title": "Show Label" },
        "label_font_size": { "type": "integer", "title": "Label Font Size", "minimum": 8, "maximum": 48 }
      }
    },
    "detections": {
      "type": "object",
      "title": "Object Detections",
      "x-ui-level": "top",
      "x-ui-order": 80,
      "x-ui-collapsed": true,
      "required": ["enabled", "color", "box_thickness", "per_class_color", "label_font_size", "min_confidence"],
      "properties": {
        "enabled": { "type": "boolean", "title": "Enabled" },
        "color": { "$ref": "#/definitions/argb_color", "title": "Default Color" },
        "box_thickness": {
          "type": "number",
          "title": "Box Thickness",
          "minimum": 0.5,
          "maximum": 10.0,
          "description": "Bounding box outline thickness in pixels"
        },
        "per_class_color": {
          "type": "boolean",
          "title": "Per-Class Colors",
          "description": "Use 8-color palette cycling by class ID"
        },
        "label_font_size": { "type": "integer", "title": "Label Font Size", "minimum": 8, "maximum": 48 },
        "min_confidence": {
          "type": "number",
          "title": "Min Confidence",
          "minimum": 0.0,
          "maximum": 1.0,
          "description": "Minimum confidence threshold for displaying detections"
        }
      }
    },
    "autofocus_debug": {
      "type": "object",
      "title": "Autofocus Debug",
      "x-ui-level": "top",
      "x-ui-order": 90,
      "x-ui-collapsed": true,
      "required": ["enabled", "position_x", "position_y", "bar_height", "heatmap_cell_size", "chart_width"],
      "properties": {
        "enabled": { "type": "boolean", "title": "Enabled" },
        "position_x": {
          "type": "integer",
          "title": "Position X",
          "minimum": 0,
          "maximum": 3840,
          "description": "Panel left edge X position"
        },
        "position_y": {
          "type": "integer",
          "title": "Position Y",
          "minimum": 0,
          "maximum": 2160,
          "description": "Panel top edge Y position"
        },
        "bar_height": {
          "type": "integer",
          "title": "Bar Height",
          "minimum": 30,
          "maximum": 200,
          "description": "Height of focus/zoom position bars in pixels"
        },
        "heatmap_cell_size": {
          "type": "integer",
          "title": "Heatmap Cell Size",
          "minimum": 4,
          "maximum": 24,
          "description": "Pixels per cell in 8x8 sharpness heatmap"
        },
        "chart_width": {
          "type": "integer",
          "title": "Chart Width",
          "minimum": 80,
          "maximum": 400,
          "description": "Width of scatter and history charts in pixels"
        }
      }
    }
  },
  "definitions": {
    "argb_color": {
      "type": "string",
      "pattern": "^#[0-9A-Fa-f]{8}$",
      "description": "ARGB color in hex format (#AARRGGBB)"
    }
  }
}
